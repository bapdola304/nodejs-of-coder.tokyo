
extends ../layout/common 
block content
	.container

		.d-flex.align-items-center
			a.btn.btn-primary(href="/products/create", data-target="#myModaladd",data-toggle="modal") Add Product
			form(action="/users/search", method="GET", class="d-flex p-2 ml-auto")
				input(type="text", name="q", value=keywork, class="form-control", id="search") 
				button(type="submit", class="btn btn-primary ml-2") Seach

			div(class="modal", id="myModaladd")
					.modal-dialog
						.modal-content
							.modal-header
								h4.modal-title Add Product
								button(type="button" class="close" data-dismiss="modal") &times;
							.modal-body
								form(action="/products/create", method="post", enctype='multipart/form-data')
									.form-group
										label Tên Sản Phẩm
										input.form-control(type="text", name="tensp")
									.form-group
										label Gía
										input.form-control(type="text", name="gia")
									.form-group
										label Mô Tả
										input.form-control(type="text", name="tomtatsp")
									.form-group
										label Ảnh SP
										input.form-control-file(type="file", name="anhsp")
						
									button.btn.btn-primary.ml-3.pl-3 Add
		.row(id="content")
			each product in products
				.col-md-3
					a(href="#" data-toggle="modal", data-target="#myModal"+product._id)
						i.fas.fa-edit
					.card
						image.card-img-top(src=product.anhsp,style='width:100%',alt="Card image")
							.card-body
								h4.card-title= product.tensp
								p.card-title= product.gia
								p.card-text= product.tomtatsp
								a.btn.btn-primary(href='cart/add/' + product._id) Add to card
				div(class="modal", id="myModal" + product._id)
					.modal-dialog
						.modal-content
							.modal-header
								h4.modal-title Edit Product
								button(type="button" class="close" data-dismiss="modal") &times;
							.modal-body
								form(action="products/edit/"+ product._id, method="post", enctype='multipart/form-data')
									.form-group
										label Tên Sản Phẩm
										input.form-control(type="text", name="tensp", value =product.tensp)
									.form-group
										label Gía
										input.form-control(type="text", name="gia", value=product.gia)
									.form-group
										label Mô Tả
										input.form-control(type="text", name="tomtatsp", value=product.tomtatsp)
									.form-group
										label Ảnh SP
										input.form-control-file(type="file", name="anhsp")
										img.col-md-6(src=product.anhsp)
									button.btn.btn-primary.ml-3.pl-3 Edit

			ul.pagination.col-md-12
				li.page-item
					a.page-link(href='#') Previous
				li.page-item
					a.page-link(href=`/products?page=${page -1}`)= page -1
				li.page-item
					a.page-link(href='/products?page=' + page)= page
				li.page-item
					a.page-link(href=`/products?page=${page-(-1)}`)= page -(-1)

	script.
		$(document).ready(function(){
			$('#search').keyup(function(){
				var data = $(this).val();
				$.post('/products/search',{data : data },function(data){
					$('#content').replaceWith(data);
				});

			});
		});
			